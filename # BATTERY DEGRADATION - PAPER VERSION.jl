# BATTERY DEGRADATION - PAPER VERSION
beta0= 4901
beta1=1.98
beta2=0.016

NSteps= 8064
soc=rand(1:100, NSteps)/100
dod=zeros(NSteps)

for i=1:NSteps
    dod[i]=1-soc[i]
end

Ncycles=zeros(NSteps)
for i=1:NSteps
    Ncycles[i]=beta0*(dod[i])^(-beta1)*exp(beta2*(soc[i]))
end

deg=zeros(NSteps-1)
for i=1:NSteps-1
    deg[i]=0.5*abs(1/Ncycles[i+1]-1/Ncycles[i])
end

tot_deg=sum(deg)

var_soc=zeros(NSteps-1)

for i=1:NSteps-1
    var_soc[i]=abs(soc[i+1]-soc[i])
end

E=sum(var_soc)
m=maximum(soc)
Neq=0.5*E/m

Ncycle_max = beta0*(1)^(-beta1)*exp(beta2*(0))
Ncycle_min= beta0*(0)^(-beta1)*exp(beta2*(1))
deg_eq=abs(1/Ncycle_max-1/Ncycle_min)

D=deg_eq*Neq

rand(1:100,87600)

println()

a=3

# VERSIONE PROF
NSteps= 1000000

S1 = [40 0 0 0 0 0 0 73.6 80 80 80 80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0]
		0	0	0	0	6.4	80	80	80	80	80	80	80	6.4	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	6.4	6.4	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	73.6	73.6	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	73.6	80	80	80	0	0	0	0	0	73.6	0	0	0	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	73.6	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	6.4	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	0	73.6	73.6	73.6	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	73.6	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	6.4	6.4	6.4	6.4	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	0	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	73.6	0	0	0	0	6.4	6.4	80	80	80	80	80	80	80	0	0	0	0	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	6.4	6.4	6.4	6.4	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	6.4	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	6.4	6.4	6.4	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	73.6	80	80	80	80	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	6.4	6.4	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	0	0	0	73.6	73.6	73.6	73.6	73.6	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	73.6	73.6	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	6.4	6.4	6.4	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	73.6	73.6	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	6.4	6.4	6.4	6.4	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	6.4	6.4	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	73.6	73.6	80	80	80	80	0	0	0	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	6.4	6.4	6.4	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	6.4	6.4	6.4	80	80	80	80	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	6.4	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	6.4	80	80	80	0	0	0	6.4	80	80	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	6.4	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	73.6	73.6	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	6.4	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	6.4	6.4	80	80	80	80	80	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	0	0	73.6	80	80	80	80	6.4	6.4	6.4	80	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	6.4	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	73.6	73.6	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	6.4	6.4	6.4	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	73.6	73.6	80	80	80	80	80	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	73.6	73.6	73.6	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	73.6	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	2.84E-14	2.84E-14	2.84E-14	2.84E-14	1.42E-14	1.42E-14	1.42E-14	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	2.84E-14	2.84E-14	2.84E-14	2.84E-14	2.84E-14	2.84E-14	2.84E-14	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	6.4	6.4	6.4	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	6.4	6.4	6.4	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	6.4	6.4	6.4	6.4	6.4	80	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	73.6	73.6	73.6	80	80	80	80	80	80	80	0	0	0	73.6	80	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	73.6	73.6	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	73.6	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	73.6	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	73.6	73.6	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	73.6	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	6.4	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	6.4	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	73.6	73.6	73.6	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	0	73.6	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	73.6	80	80	80	80	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	6.4	6.4	6.4	6.4	6.4	80	80	80	80	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	73.6	80	80	80	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	73.6	73.6	73.6	73.6	73.6	73.6	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	73.6	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	80	80	80	80	80	80	80	80	80	80	0	0	0	0 0 0 0 0 0 6.4 80 80 80 80 80	80	0	0	0	73.6	80	80	80	80	80	0	0	0	0	0	0	0	0	0	0	6.4	80	80	80	0	0	0 0	6.4	80 80 80 80 80 80 0 0 0 0 0 0 6.4 80 80 80 80 80 80 0 0 0 0 6.4 80 80 80 80 0 0 0 0 0 0];
S=S1/max(S1);
soc1=rand(1:90, NSteps)

soc=soc1/maximum(soc1)
DoD=zeros(NSteps)

for i=1:NSteps
    DoD[i]=1-soc[i]
end

beta0= 4901
beta1= 1.98
beta2= 0.016

deg=zeros(NSteps)

for i=1:(NSteps-1)
    a1=beta0*(DoD[i+1]^(-beta1))*exp(beta2*(1-DoD[i+1]))                             # Equazione per calcolo numero cicli in funzione di DoD
    a0=beta0*(DoD[i]^(-beta1))*exp(beta2*(1-DoD[i]))

    deg[i]=0.5*abs(1/a1-1/a0)
end

DEG=sum(deg)

#SOC VIRTUALE
A=zeros(NSteps)

for j=1:(NSteps-1)
    A[j]=abs(soc[j+1]-soc[j])
end

A_sum= sum(A)
N_eq=0.5*A_sum/maximum(soc)                         # sostanzialmente quanti cicli da DoD0100% per poter "degradare" la batteria di quantità A

a1_eq=beta0*(1^(-beta1))*exp(beta2*(1-1))           #Ciclo completo con DoD=100
a0_eq=beta0*(0^(-beta1))*exp(beta2*(1-0))
deg_eq=abs(1/a1_eq-1/a0_eq)

DEG_1=deg_eq*N_eq
